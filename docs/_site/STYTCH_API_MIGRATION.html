<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  
  <link rel="stylesheet" href="/assets/main.css"><link type="application/atom+xml" rel="alternate" href="http://localhost:4000/feed.xml" title="SideSpins" /></head>
<body><header class="site-header" role="banner">

  <div class="wrapper"><a class="site-title" rel="author" href="/">SideSpins</a><nav class="site-nav">
        <input type="checkbox" id="nav-trigger" class="nav-trigger" />
        <label for="nav-trigger">
          <span class="menu-icon">
            <svg viewBox="0 0 18 15" width="18px" height="15px">
              <path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z"/>
            </svg>
          </span>
        </label>

        <div class="trigger"><a class="page-link" href="/">Home</a><a class="page-link" href="/schedule.html">Schedule</a><a class="page-link" href="/lineup-explorer.html">Lineup Explorer</a><a class="page-link" href="/availability.html">Availability</a></div>
      </nav></div>
</header>
<main class="page-content" aria-label="Content">
      <div class="wrapper">
        <article class="post">

  <header class="post-header">
    <h1 class="post-title">Stytch SDK to Direct API Migration</h1>
  </header>

  <div class="post-content">
    <h1 id="stytch-sdk-to-direct-api-migration">Stytch SDK to Direct API Migration</h1>

<h2 id="overview">Overview</h2>
<p>This document outlines the migration from Stytch JavaScript SDK to direct API calls for the SideSpins authentication system.</p>

<h2 id="changes-made">Changes Made</h2>

<h3 id="1-loginhtml">1. login.html</h3>
<ul>
  <li><strong>Removed</strong>: Stytch SDK script and initialization</li>
  <li><strong>Added</strong>: Direct API calling functionality with <code class="language-plaintext highlighter-rouge">callStytchAPI()</code> helper function</li>
  <li><strong>Updated</strong>: SMS OTP authentication to use <code class="language-plaintext highlighter-rouge">/otps/sms/login_or_create</code> and <code class="language-plaintext highlighter-rouge">/otps/sms/authenticate</code> endpoints</li>
  <li><strong>Updated</strong>: Magic link authentication to use <code class="language-plaintext highlighter-rouge">/magic_links/email/login_or_create</code> endpoint</li>
</ul>

<h3 id="2-authcallbackhtml">2. auth/callback.html</h3>
<ul>
  <li><strong>Removed</strong>: Stytch SDK script and initialization</li>
  <li><strong>Added</strong>: Direct API calling functionality</li>
  <li><strong>Updated</strong>: Magic link authentication callback to use <code class="language-plaintext highlighter-rouge">/magic_links/authenticate</code> endpoint</li>
</ul>

<h2 id="api-endpoints-used">API Endpoints Used</h2>

<h3 id="sms-authentication">SMS Authentication</h3>
<ol>
  <li><strong>Send SMS OTP</strong>: <code class="language-plaintext highlighter-rouge">POST /v1/otps/sms/login_or_create</code>
    <ul>
      <li>Body: <code class="language-plaintext highlighter-rouge">{ "phone_number": "+1234567890" }</code></li>
    </ul>
  </li>
  <li><strong>Verify SMS OTP</strong>: <code class="language-plaintext highlighter-rouge">POST /v1/otps/sms/authenticate</code>
    <ul>
      <li>Body: <code class="language-plaintext highlighter-rouge">{ "phone_number": "+1234567890", "code": "123456", "session_duration_minutes": 60 }</code></li>
    </ul>
  </li>
</ol>

<h3 id="magic-link-authentication">Magic Link Authentication</h3>
<ol>
  <li><strong>Send Magic Link</strong>: <code class="language-plaintext highlighter-rouge">POST /v1/magic_links/email/login_or_create</code>
    <ul>
      <li>Body: <code class="language-plaintext highlighter-rouge">{ "email": "user@example.com", "login_magic_link_url": "...", "signup_magic_link_url": "..." }</code></li>
    </ul>
  </li>
  <li><strong>Authenticate Magic Link</strong>: <code class="language-plaintext highlighter-rouge">POST /v1/magic_links/authenticate</code>
    <ul>
      <li>Body: <code class="language-plaintext highlighter-rouge">{ "token": "magic_link_token", "session_duration_minutes": 60 }</code></li>
    </ul>
  </li>
</ol>

<h2 id="configuration-required">Configuration Required</h2>

<h3 id="important-update-api-configuration">Important: Update API Configuration</h3>
<p>You need to update the following configuration values in both files:</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">const</span> <span class="nx">STYTCH_PROJECT_ID</span> <span class="o">=</span> <span class="dl">'</span><span class="s1">project-test-a2f77b99-578b-4bb0-986f-7b0404a5bf4b</span><span class="dl">'</span><span class="p">;</span> <span class="c1">// Replace with your actual project ID</span>
<span class="kd">const</span> <span class="nx">STYTCH_PUBLIC_TOKEN</span> <span class="o">=</span> <span class="dl">'</span><span class="s1">public-token-test-a2f77b99-578b-4bb0-986f-7b0404a5bf4b</span><span class="dl">'</span><span class="p">;</span> <span class="c1">// Your public token</span>
<span class="kd">const</span> <span class="nx">STYTCH_API_BASE</span> <span class="o">=</span> <span class="dl">'</span><span class="s1">https://test.stytch.com/v1</span><span class="dl">'</span><span class="p">;</span> <span class="c1">// Use 'https://api.stytch.com/v1' for production</span>
</code></pre></div></div>

<h3 id="environment-specific-urls">Environment-Specific URLs</h3>
<ul>
  <li><strong>Test Environment</strong>: <code class="language-plaintext highlighter-rouge">https://test.stytch.com/v1</code></li>
  <li><strong>Production Environment</strong>: <code class="language-plaintext highlighter-rouge">https://api.stytch.com/v1</code></li>
</ul>

<h2 id="authentication-method">Authentication Method</h2>
<p>The implementation uses HTTP Basic Authentication with:</p>
<ul>
  <li><strong>Username</strong>: Your Stytch Project ID</li>
  <li><strong>Password</strong>: Your Stytch Public Token</li>
</ul>

<h2 id="error-handling">Error Handling</h2>
<p>Enhanced error handling now includes:</p>
<ul>
  <li>Specific error messages from Stytch API responses</li>
  <li>Proper logging of API responses for debugging</li>
  <li>Fallback error messages for network issues</li>
</ul>

<h2 id="benefits-of-direct-api-calls">Benefits of Direct API Calls</h2>
<ol>
  <li><strong>Reduced Bundle Size</strong>: No need to load the Stytch SDK</li>
  <li><strong>Better Control</strong>: Direct control over API requests and responses</li>
  <li><strong>Debugging</strong>: Easier to debug and monitor API calls</li>
  <li><strong>Customization</strong>: Easier to customize request/response handling</li>
</ol>

<h2 id="testing">Testing</h2>
<p>After updating the configuration:</p>
<ol>
  <li>Test SMS OTP flow</li>
  <li>Test Magic Link flow</li>
  <li>Verify error handling scenarios</li>
  <li>Check browser console for any API errors</li>
</ol>

<h2 id="security-notes">Security Notes</h2>
<ul>
  <li>The public token is safe to use in client-side code</li>
  <li>All sensitive operations still require backend validation</li>
  <li>Session exchange with your backend remains unchanged</li>
</ul>

  </div>

</article>

      </div>
    </main><footer class="site-footer h-card">
  <data class="u-url" href="/"></data>

  <div class="wrapper">
    <div class="footer-col-wrapper">
      <div class="footer-col footer-col-1">
        <h2 class="footer-heading">SideSpins</h2></div>

      <div class="footer-col footer-col-2">
        <!-- This column is intentionally left empty -->
      </div>

      <div class="footer-col footer-col-3">
        <p>Unofficial homepage for Break of Dawn.</p>
      </div>
    </div>
  </div>
</footer>
</body>

</html>
